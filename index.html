<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tablero de Cartera</title>
    
    <!-- 1. Estilos (Tailwind CSS) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. React y ReactDOM (Producción) -->
    <script crossorigin src="https://unpkg.com/react@18.3.1/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.3.1/umd/react-dom.production.min.js"></script>
    
    <!-- 3. Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @keyframes pulse-slow {
            0%, 100% { opacity: 1; }
            50% { opacity: .8; }
        }
        .animate-pulse-slow {
            animation: pulse-slow 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        body { font-family: system-ui, -apple-system, sans-serif; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo } = React;

        // --- ICONOS INTEGRADOS (SVG Nativos) ---
        const IconBase = ({ children, className, ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{children}</svg>
        );

        const Icons = {
            AlertCircle: (p) => <IconBase {...p}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></IconBase>,
            CheckCircle: (p) => <IconBase {...p}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></IconBase>,
            Search: (p) => <IconBase {...p}><circle cx="11" cy="11" r="8"/><line x1="21" x2="16.65" y1="21" y2="16.65"/></IconBase>,
            RefreshCw: (p) => <IconBase {...p}><path d="M21 2v6h-6"/><path d="M3 12a9 9 0 0 1 15-6.7L21 8"/><path d="M3 22v-6h6"/><path d="M21 12a9 9 0 0 1-15 6.7L3 16"/></IconBase>,
            CreditCard: (p) => <IconBase {...p}><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></IconBase>,
            FileText: (p) => <IconBase {...p}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></IconBase>,
            XCircle: (p) => <IconBase {...p}><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></IconBase>,
            HelpCircle: (p) => <IconBase {...p}><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></IconBase>,
            BellRing: (p) => <IconBase {...p}><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></IconBase>,
            Filter: (p) => <IconBase {...p}><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></IconBase>,
            User: (p) => <IconBase {...p}><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></IconBase>,
            Users: (p) => <IconBase {...p}><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></IconBase>,
            TrendingDown: (p) => <IconBase {...p}><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"/><polyline points="17 18 23 18 23 12"/></IconBase>,
            DollarSign: (p) => <IconBase {...p}><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></IconBase>,
            X: (p) => <IconBase {...p}><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></IconBase>,
            Target: (p) => <IconBase {...p}><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></IconBase>,
            Handshake: (p) => <IconBase {...p}><path d="m11 17 2 2a1 1 0 1 0 3-3"/><path d="m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-1.42-1.42l4.82-4.82a1 1 0 0 1 1.42 0l2.12 2.12a1 1 0 0 0 1.42 0l1.29-1.29a3 3 0 0 0 0-4.24l-2.12-2.12a3 3 0 0 0-4.24 0l-3.65 3.65a3 3 0 0 0 0 4.24l.88.88a1 1 0 0 1-1.42 1.42l-4.24-4.24a1 1 0 0 0-1.42 0l-2.12 2.12a3 3 0 0 0 0 4.24l2.12 2.12"/><path d="m7 13 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-1.42-1.42l4.82-4.82a1 1 0 0 1 1.42 0l2.12 2.12a1 1 0 0 0 1.42 0l1.29-1.29a3 3 0 0 0 0-4.24l-2.12-2.12a3 3 0 0 0-4.24 0l-3.65 3.65a3 3 0 0 0 0 4.24l.88.88a1 1 0 0 1-1.42 1.42l-4.24-4.24a1 1 0 0 0-1.42 0l-2.12 2.12a3 3 0 0 0 0 4.24l2.12 2.12"/></IconBase>,
            Smartphone: (p) => <IconBase {...p}><rect x="5" y="2" width="14" height="20" rx="2" ry="2"/><line x1="12" y1="18" x2="12.01" y2="18"/></IconBase>,
            ShieldAlert: (p) => <IconBase {...p}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></IconBase>,
            AlertTriangle: (p) => <IconBase {...p}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></IconBase>,
            Phone: (p) => <IconBase {...p}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></IconBase>,
            MessageCircle: (p) => <IconBase {...p}><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></IconBase>,
            Lock: (p) => <IconBase {...p}><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></IconBase>,
            Database: (p) => <IconBase {...p}><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></IconBase>
        };

        // --- CONFIGURACIÓN ---
        const API_URL = 'https://script.google.com/macros/s/AKfycbz770i0j3vK5-9M2Z2EheDh9GX2x2j2KbjfFm_yNadBg5db3tEc5so58KWeIX5SwTmAZw/exec';
        const APP_VERSION = "v3.3.0 (Dropdown + Fix)";

        // ETIQUETAS DE CUOTAS
        const QUOTA_LABELS = {
            q1: { id: 'primera', label: 'Primera Cuota', weeksAgo: 3 },
            fpd3: { id: 'primera', label: 'FPD3 (Hace 2 Semanas)', weeksAgo: 2 },  
            fpd7: { id: 'primera', label: 'FPD7 (Hace 3 Semanas)', weeksAgo: 3 }, 
            fpd15: { id: 'primera', label: 'FPD15 (Hace 4 Semanas)', weeksAgo: 4 }  
        };

        // CONFIGURACIÓN DE CARTERAS
        const PORTFOLIO_CONFIG = {
            alocredit: {
                name: "ALOCREDIT",
                theme: "indigo",
                // CORRECCIÓN: Alocredit también usa los 3 tiempos FPD
                quotas: ['fpd3', 'fpd7', 'fpd15'], 
                columns: {
                    seller: ['responsable', 'vendedor', 'asesor'],
                    client: ['cliente', 'nombre', 'nombres', 'nombre cliente'], 
                    device: ['modelo - equipo', 'equipo', 'modelo'],
                    phone: ['celular', 'telefono', 'teléfono', 'movil', 'contacto'], 
                    date: ['fecha venta', 'fecha desembolso', 'fecha creacion', 'fecha'],
                    quotaDate: 'cuota',
                    observation: 'pagos' 
                }
            },
            payjoy: {
                name: "PAYJOY",
                theme: "blue",
                quotas: ['fpd3', 'fpd7', 'fpd15'], 
                columns: {
                    seller: ['vendedor', 'asesor', 'ejecutivo'],
                    client: ['cliente', 'nombre', 'nombres', 'nombre cliente'], 
                    device: ['equipo', 'modelo', 'celular'],
                    phone: ['celular', 'telefono', 'teléfono', 'movil', 'contacto'], 
                    date: ['fecha venta', 'fecha desembolso', 'fecha'],
                    quotaDate: 'cuota',
                    observation: 'observa'
                }
            }
        };

        // --- COMPONENTE LOGIN ---
        const Login = ({ onLogin }) => {
            const [user, setUser] = useState('');
            const [pass, setPass] = useState('');
            const [error, setError] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                if (user.toUpperCase() === 'ADMIN' && pass === 'Cescode1@') {
                    onLogin();
                } else {
                    setError('Credenciales incorrectas');
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center bg-slate-100 p-4">
                    <div className="bg-white p-8 rounded-xl shadow-lg w-full max-w-sm border border-slate-200">
                        <div className="flex justify-center mb-6">
                            <div className="p-4 bg-indigo-50 rounded-full border border-indigo-100">
                                <Icons.Lock className="w-8 h-8 text-indigo-600" />
                            </div>
                        </div>
                        <h2 className="text-2xl font-bold text-center text-slate-800 mb-1">Acceso Seguro</h2>
                        <p className="text-center text-slate-500 text-sm mb-6">Plataforma de Gestión</p>
                        
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="block text-xs font-bold text-slate-600 uppercase mb-1">Usuario</label>
                                <div className="relative">
                                    <input 
                                        type="text" 
                                        value={user}
                                        onChange={(e) => setUser(e.target.value)}
                                        className="w-full pl-10 pr-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition text-sm"
                                        placeholder="Ingrese su usuario"
                                    />
                                    <Icons.User className="w-4 h-4 text-slate-400 absolute left-3 top-3.5" />
                                </div>
                            </div>
                            <div>
                                <label className="block text-xs font-bold text-slate-600 uppercase mb-1">Contraseña</label>
                                <div className="relative">
                                    <input 
                                        type="password" 
                                        value={pass}
                                        onChange={(e) => setPass(e.target.value)}
                                        className="w-full pl-10 pr-4 py-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition text-sm"
                                        placeholder="Ingrese su contraseña"
                                    />
                                    <Icons.ShieldAlert className="w-4 h-4 text-slate-400 absolute left-3 top-3.5" />
                                </div>
                            </div>
                            
                            {error && (
                                <div className="p-3 bg-red-50 text-red-600 text-xs rounded-lg flex items-center gap-2">
                                    <Icons.AlertTriangle className="w-4 h-4" />
                                    {error}
                                </div>
                            )}

                            <button type="submit" className="w-full bg-slate-800 text-white py-2.5 rounded-lg font-bold hover:bg-slate-900 transition transform active:scale-[0.98] shadow-sm">
                                Ingresar
                            </button>
                        </form>
                    </div>
                </div>
            );
        };

        // --- COMPONENTE PRINCIPAL ---
        function App() {
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [portfolio, setPortfolio] = useState('alocredit');
            const activeConfig = PORTFOLIO_CONFIG[portfolio];

            const [data, setData] = useState([]);
            const [headers, setHeaders] = useState([]);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            
            // Filtros
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedSeller, setSelectedSeller] = useState('');
            const [selectedDevice, setSelectedDevice] = useState('');
            const [showOnlyAlerts, setShowOnlyAlerts] = useState(false);
            
            // Filtros interactivos
            const [fpdQuotaFilter, setFpdQuotaFilter] = useState(null); 
            const [breakdownFilter, setBreakdownFilter] = useState(null);

            // --- UTILS ---
            const parseDate = (dateVal) => {
                if (!dateVal) return null;
                let dateObj = null;
                if (typeof dateVal === 'string' && dateVal.length > 5) {
                    dateObj = new Date(dateVal);
                } else if (dateVal instanceof Date) {
                    dateObj = dateVal;
                }
                if (!dateObj || isNaN(dateObj.getTime())) return null;
                return dateObj;
            };

            const checkDateAlert = (dateVal) => {
                const dateObj = parseDate(dateVal);
                if (!dateObj) return false;
                const now = new Date();
                const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                const due = new Date(dateObj.getFullYear(), dateObj.getMonth(), dateObj.getDate());
                const diffTime = today - due;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
                return diffDays >= 5 && diffDays <= 7;
            };

            const findColumnName = useCallback((keyword1, keyword2, headersList) => {
                if (!headersList) return null;
                return headersList.find(h => {
                    const lower = String(h).toLowerCase();
                    return lower.includes(keyword1) && (keyword2 ? lower.includes(keyword2) : true);
                });
            }, []);

            const findConfigColumn = useCallback((possibleNames, headersList) => {
                if (!possibleNames || !headersList) return null;
                for (const name of possibleNames) {
                    const found = headersList.find(h => h.toLowerCase().includes(name));
                    if (found) return found;
                }
                return null;
            }, []);

            const formatCellData = (value) => {
                if (typeof value !== 'string') {
                    if (typeof value === 'object' && value !== null) return JSON.stringify(value);
                    return String(value);
                }
                if (value.length > 5 && value.length < 30 && (value.includes('-') || value.includes('/'))) {
                    const d = parseDate(value);
                    if (d && !isNaN(d.getTime())) return d.toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric' });
                }
                return value;
            };

            const cleanPhoneNumber = (phone) => {
                if (!phone) return '';
                return String(phone).replace(/\D/g, '');
            };

            const getWhatsAppLink = (phone, clientName, deviceName) => {
                const clean = cleanPhoneNumber(phone);
                if (!clean) return '#';
                const companyName = portfolio === 'payjoy' ? 'Payjoy' : 'Alocredit';
                let greeting = "Hola";
                if (clientName && typeof clientName === 'string') {
                    const cleanName = clientName.trim();
                    if (cleanName.length > 1) greeting += ` ${cleanName}`;
                }
                let deviceText = "";
                if (deviceName && typeof deviceName === 'string' && deviceName.trim().length > 1) {
                    deviceText = ` de su equipo ${deviceName.trim()}`;
                }
                const message = `${greeting}, le recordamos que la cuota${deviceText} financiado con ${companyName} se encuentra vencida. Si ya realizó el pago por favor infórmenos.`;
                return `https://wa.me/${clean}?text=${encodeURIComponent(message)}`;
            };

            const getCohortRange = (weeksAgo) => {
                const now = new Date();
                const currentDay = now.getDay(); 
                const distanceToMonday = (currentDay === 0 ? 6 : currentDay - 1); 
                const currentMonday = new Date(now);
                currentMonday.setDate(now.getDate() - distanceToMonday);
                currentMonday.setHours(0, 0, 0, 0);

                const start = new Date(currentMonday);
                start.setDate(currentMonday.getDate() - (weeksAgo * 7));
                
                const end = new Date(start);
                end.setDate(start.getDate() + 6);
                end.setHours(23, 59, 59, 999);
                return { start, end };
            };

            const isObsUnpaid = (val) => {
                const v = String(val || '').toLowerCase().trim();
                // 1. REGLA POSITIVA (Gestión Exitosa / Pagado con gestión)
                if (v.includes('gets solutions pago cuota') || v.includes('con gestion') || v.includes('con gestión')) return false;
                
                // 2. REGLA NEGATIVA (Impago Explícito)
                if (v.includes('no se cancelo cuota') || v.includes('no cancelo') || v.includes('no canceló') || v.includes('no pago') || v.includes('no pagó')) return true;

                // 3. REGLA COMPROMISO (Impago)
                if (v.includes('compromiso')) return true;

                // 4. REGLA PAGO ORGÁNICO
                if (v.includes('ya cancelo') || v.includes('ya canceló') || v.includes('cancelo') || v.includes('canceló') || v.includes('pagó') || v.includes('pago')) return false;
                
                // 5. DEFAULT (Vacío = Impago)
                return v === '';
            };

            // --- FETCH DATA ---
            const fetchData = useCallback(async () => {
                setLoading(true);
                setError(null);
                setSelectedSeller('');
                setSelectedDevice('');
                setFpdQuotaFilter(null);
                setBreakdownFilter(null);
                setShowOnlyAlerts(false);

                try {
                    const separator = API_URL.includes('?') ? '&' : '?';
                    const cacheBusterUrl = `${API_URL}${separator}type=${portfolio}&t=${new Date().getTime()}`;
                    const response = await fetch(cacheBusterUrl, { method: "GET", redirect: "follow" });
                    
                    if (!response.ok) throw new Error(`Error servidor: ${response.status}`);
                    
                    const text = await response.text();
                    let jsonData;
                    try {
                        jsonData = JSON.parse(text);
                    } catch (e) {
                        throw new Error('Respuesta no válida del servidor.');
                    }
                    
                    if (!Array.isArray(jsonData) || jsonData.length === 0) {
                         if (jsonData && jsonData.result === 'error') throw new Error(jsonData.error);
                         throw new Error('La hoja está vacía.');
                    }

                    const keys = Object.keys(jsonData[0]);
                    setHeaders(keys);
                    setData(jsonData);
                } catch (err) {
                    console.error(err);
                    setError(String(err.message || 'Error desconocido.'));
                    setData([]);
                    setHeaders([]);
                } finally {
                    setLoading(false);
                }
            }, [portfolio]); 

            useEffect(() => { 
                if (isAuthenticated) fetchData(); 
            }, [fetchData, isAuthenticated]);

            // --- MEMOS DE DATOS ---
            const { sellers, sellerColumn, devices, deviceColumn, phoneColumn, clientColumn } = useMemo(() => {
                const sCol = findConfigColumn(activeConfig.columns.seller, headers);
                const dCol = findConfigColumn(activeConfig.columns.device, headers);
                const pCol = findConfigColumn(activeConfig.columns.phone, headers);
                const cCol = findConfigColumn(activeConfig.columns.client, headers); 

                const uniqueSellers = new Set();
                const uniqueDevices = new Set();
                data.forEach(row => {
                    if (sCol && row[sCol]) uniqueSellers.add(String(row[sCol]).trim());
                    if (dCol && row[dCol]) uniqueDevices.add(String(row[dCol]).trim());
                });
                return { 
                    sellers: Array.from(uniqueSellers).sort(), sellerColumn: sCol,
                    devices: Array.from(uniqueDevices).sort(), deviceColumn: dCol,
                    phoneColumn: pCol, clientColumn: cCol
                };
            }, [data, headers, activeConfig, findConfigColumn]);

            const checkSpecificQuotaAlert = (row, headersList, quotaId) => {
                const qName = QUOTA_LABELS[quotaId]?.id; 
                if (!qName) return false;
                const colFecha = findColumnName(qName, activeConfig.columns.quotaDate, headersList);
                
                let colObs = findColumnName(activeConfig.columns.observation, qName, headersList);
                if (!colObs && portfolio === 'alocredit' && quotaId === 'q1') {
                    colObs = findColumnName(activeConfig.columns.observation, '', headersList);
                }

                if (colFecha && colObs) {
                    const fechaVal = row[colFecha];
                    const obsVal = String(row[colObs] || '').trim();
                    if (checkDateAlert(fechaVal) && obsVal === '') return true;
                }
                return false;
            };

            const getRowAlertStatus = (row, headersList) => {
                return activeConfig.quotas.some(qId => checkSpecificQuotaAlert(row, headersList, qId));
            };

            // --- LOGICA DE FILTRADO PRINCIPAL ---
            const filteredData = useMemo(() => {
                let result = data;
                if (selectedSeller && sellerColumn) result = result.filter(row => String(row[sellerColumn]).trim() === selectedSeller);
                if (selectedDevice && deviceColumn) result = result.filter(row => String(row[deviceColumn]).trim() === selectedDevice);
                
                if (searchTerm) {
                    result = result.filter(row => headers.some(header => String(row[header]).toLowerCase().includes(searchTerm.toLowerCase())));
                }
                if (showOnlyAlerts) {
                    result = result.filter(row => getRowAlertStatus(row, headers));
                }

                if (fpdQuotaFilter) {
                    const dateCol = findConfigColumn(activeConfig.columns.date, headers);
                    if (dateCol) {
                        const weeksAgo = QUOTA_LABELS[fpdQuotaFilter].weeksAgo;
                        const range = getCohortRange(weeksAgo);

                        result = result.filter(row => {
                            const d = parseDate(row[dateCol]);
                            if (!d || d < range.start || d > range.end) return false;
                            
                            let quotaName = QUOTA_LABELS[fpdQuotaFilter].id;
                            
                            let obsCol = findColumnName(activeConfig.columns.observation, quotaName, headers);
                            if (!obsCol && portfolio === 'alocredit') {
                                obsCol = findColumnName(activeConfig.columns.observation, '', headers);
                            }

                            let quotaDateCol = findColumnName(quotaName, activeConfig.columns.quotaDate, headers);
                            
                            const now = new Date(); now.setHours(0,0,0,0);
                            if (quotaDateCol) {
                                const qDate = parseDate(row[quotaDateCol]);
                                if (qDate && qDate >= now) return false; 
                            }
                            if (obsCol) return isObsUnpaid(row[obsCol]);
                            return false;
                        });
                    }
                }

                if (breakdownFilter) {
                   const { quota, type } = breakdownFilter;
                   let qName = QUOTA_LABELS[quota].id;
                   let colName = findColumnName(activeConfig.columns.observation, qName, headers);
                   if (!colName && portfolio === 'alocredit') {
                       colName = findColumnName(activeConfig.columns.observation, '', headers);
                   }
                   
                   if (colName) {
                       result = result.filter(row => {
                           const val = String(row[colName] || '').toLowerCase().trim();
                           if (type === 'vacio') return !val;
                           
                           if (type === 'noCancelo') {
                               if (val.includes('no se cancelo cuota')) return true;
                               if (val.includes('no cancelo') || val.includes('no canceló') || val.includes('no pago')) return true;
                               return val.includes('compromiso'); 
                           }
                           
                           if (type === 'conGestion') {
                               if (val.includes('gets solutions pago cuota')) return true;
                               return val.includes('ya cancelo cuota') || val.includes('con gestion') || val.includes('con gestión');
                           }
                           
                           if (type === 'yaCancelo') {
                               if (val.includes('gets solutions pago cuota') || val.includes('ya cancelo cuota') || val.includes('con gestion')) return false;
                               return val.includes('ya cancelo') || val.includes('ya canceló') || val.includes('cancelo') || val.includes('canceló') || val.includes('pagó') || val.includes('pago');
                           }
                           
                           if (type === 'compromiso') return val.includes('compromiso');

                           return false;
                       });
                   }
                }
                return result;
            }, [data, headers, searchTerm, showOnlyAlerts, fpdQuotaFilter, breakdownFilter, selectedSeller, sellerColumn, selectedDevice, deviceColumn, activeConfig, findColumnName, findConfigColumn, portfolio]);

            // --- ESTADISTICAS ---
            const dataForStats = useMemo(() => {
                let result = data;
                if (selectedSeller && sellerColumn) result = result.filter(row => String(row[sellerColumn]).trim() === selectedSeller);
                if (selectedDevice && deviceColumn) result = result.filter(row => String(row[deviceColumn]).trim() === selectedDevice);
                return result;
            }, [data, selectedSeller, sellerColumn, selectedDevice, deviceColumn]);

            const alertStats = useMemo(() => {
                let stats = { total: 0 };
                dataForStats.forEach(row => { if (getRowAlertStatus(row, headers)) stats.total++; });
                return stats;
            }, [dataForStats, headers, activeConfig]);

            const fpdStats = useMemo(() => {
                const dateCol = findConfigColumn(activeConfig.columns.date, headers);
                if (!dateCol) return { found: false };

                const formatDateShort = (d) => d.toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit' });
                const now = new Date(); now.setHours(0,0,0,0);

                const calculateFPD = (quotaKey) => {
                    const qName = QUOTA_LABELS[quotaKey].id;
                    const weeksAgo = QUOTA_LABELS[quotaKey].weeksAgo;

                    const range = getCohortRange(weeksAgo);
                    const cohortSales = dataForStats.filter(row => {
                        const d = parseDate(row[dateCol]);
                        return d && d >= range.start && d <= range.end;
                    });
                    const totalSales = cohortSales.length;
                    
                    const rangeStr = `${formatDateShort(range.start)} - ${formatDateShort(range.end)}`;
                    if (totalSales === 0) return { totalSales: 0, unpaid: 0, rangeStr };

                    let obsCol = findColumnName(activeConfig.columns.observation, qName, headers);
                    if (!obsCol && portfolio === 'alocredit') {
                        obsCol = findColumnName(activeConfig.columns.observation, '', headers);
                    }

                    const quotaDateCol = findColumnName(qName, activeConfig.columns.quotaDate, headers);
                    let unpaid = 0;
                    if (obsCol) {
                        unpaid = cohortSales.filter(row => {
                            if (quotaDateCol) {
                                const qDate = parseDate(row[quotaDateCol]);
                                if (qDate && qDate >= now) return false; 
                            }
                            const val = String(row[obsCol] || '').toLowerCase().trim();
                            return isObsUnpaid(val);
                        }).length;
                    }
                    return { totalSales, unpaid, rangeStr };
                };

                const fpd3 = calculateFPD('fpd3');
                const fpd7 = calculateFPD('fpd7');
                const fpd15 = calculateFPD('fpd15');

                let totalUnpaid = 0, totalSales = 0;
                [fpd3, fpd7, fpd15].forEach(s => {
                    if (s) { totalUnpaid += s.unpaid; totalSales += s.totalSales; }
                });
                
                const generalFPD = totalSales > 0 ? ((totalUnpaid / totalSales) * 100).toFixed(1) : 0;
                return { found: true, colUsed: String(dateCol), generalFPD, totalSalesAll: totalSales, fpd3, fpd7, fpd15 };
            }, [dataForStats, headers, activeConfig, findColumnName, findConfigColumn, portfolio]);

            const observationStats = useMemo(() => {
                const calc = (quotaKey) => {
                    const qName = QUOTA_LABELS[quotaKey].id;
                    let s = { conGestion: 0, noCancelo: 0, yaCancelo: 0, vacio: 0 };
                    let col = findColumnName(activeConfig.columns.observation, qName, headers);
                    if (!col && portfolio === 'alocredit') col = findColumnName(activeConfig.columns.observation, '', headers);

                    if(!col) return s;
                    filteredData.forEach(row => {
                        const val = String(row[col] || '').toLowerCase().trim();
                        if (!val) s.vacio++;
                        else if (val.includes('no se cancelo cuota')) s.noCancelo++;
                        else if (val.includes('no cancelo') || val.includes('no canceló') || val.includes('no pago')) s.noCancelo++;
                        else if (val.includes('compromiso')) s.noCancelo++;

                        else if (val.includes('gets solutions pago cuota')) s.conGestion++;
                        else if (val.includes('ya cancelo cuota') || val.includes('con gestion') || val.includes('con gestión')) s.conGestion++;
                        else if (val.includes('ya cancelo') || val.includes('ya canceló') || val.includes('cancelo') || val.includes('pagó') || val.includes('pago')) s.yaCancelo++;
                    });
                    return s;
                }
                return {
                    fpd3: calc('fpd3'), fpd7: calc('fpd7'), fpd15: calc('fpd15'), found: true
                };
            }, [filteredData, headers, findColumnName, activeConfig, portfolio]);

            const getColumnStyles = (headerName) => {
                if (!headerName) return null;
                const lowerHeader = String(headerName).toLowerCase().trim();
                if (lowerHeader.includes("primera cuota")) return { head: "bg-blue-100 text-blue-900 border-b-2 border-blue-300", cellBase: "border-l border-r border-blue-100", bgColor: "bg-blue-50/50" };
                return null;
            };

            const StatCard = ({ title, stats, quotaId, fpdInfo }) => {
                if (!stats) return null;
                let fpdPercent = "0.0", recoverNeeded = 0, targetPercent = 10;
                
                let hasSales = fpdInfo && fpdInfo.totalSales > 0;
                if (hasSales) {
                    fpdPercent = ((fpdInfo.unpaid / fpdInfo.totalSales) * 100).toFixed(1);
                    const maxAllowed = Math.floor((fpdInfo.totalSales * targetPercent) / 100);
                    recoverNeeded = Math.max(0, fpdInfo.unpaid - maxAllowed);
                }
                let fpdColor = hasSales 
                    ? (parseFloat(fpdPercent) > 30 ? "text-red-700 bg-red-100" : parseFloat(fpdPercent) > 15 ? "text-yellow-700 bg-yellow-100" : "text-green-700 bg-green-100") 
                    : "text-slate-500 bg-slate-100";
                
                const isFpdActive = fpdQuotaFilter === quotaId;
                const isActive = (t) => breakdownFilter && breakdownFilter.quota === quotaId && breakdownFilter.type === t;
                const baseRow = "flex justify-between items-center p-2 rounded cursor-pointer transition-colors hover:ring-1 hover:ring-indigo-300";

                return (
                    <div className={`p-4 rounded-xl border shadow-sm bg-white border-slate-200`}>
                        <div className="flex items-center gap-2 mb-3 border-b pb-2">
                             <Icons.FileText className="w-4 h-4 text-slate-600" />
                             <h3 className="text-sm font-bold uppercase tracking-wide text-slate-700">{title}</h3>
                        </div>
                        <div 
                            onClick={() => { if(hasSales) { setFpdQuotaFilter(isFpdActive ? null : quotaId); setBreakdownFilter(null); setShowOnlyAlerts(false); }}}
                            className={`mb-3 p-3 rounded-lg ${fpdColor} border border-white/50 shadow-sm transition-all ${hasSales ? 'cursor-pointer hover:ring-2 hover:ring-indigo-400' : ''} ${isFpdActive ? 'ring-2 ring-indigo-500' : ''}`}
                        >
                            <div className="flex justify-between mb-2">
                                <span className="text-[10px] font-bold uppercase opacity-80 flex items-center gap-1">{isFpdActive && <Icons.Filter className="w-3 h-3 animate-pulse"/>} FPD7 (Sem -{QUOTA_LABELS[quotaId].weeksAgo})</span>
                                <span className="text-xl font-bold">{hasSales ? `${fpdPercent}%` : 'N/A'}</span>
                            </div>
                            {hasSales && fpdInfo ? (
                                <div className="text-[11px] space-y-1 border-t border-black/10 pt-2">
                                    <div className="flex justify-between"><span className="opacity-80">Ventas:</span><span className="font-bold">{fpdInfo.totalSales}</span></div>
                                    <div className={`flex justify-between p-1 -mx-1 rounded ${isFpdActive ? 'bg-white/40 font-bold' : ''}`}>
                                        <span className="opacity-80">No Han Pagado:</span><span className="font-bold underline">{fpdInfo.unpaid}</span>
                                    </div>
                                    <div className="flex justify-between text-red-800 font-bold mt-1 bg-white/30 p-1 rounded -mx-1">
                                        <span className="text-[10px] flex items-center gap-1"><Icons.Target className="w-3 h-3"/> Meta {targetPercent}%:</span><span>{recoverNeeded}</span>
                                    </div>
                                    <div className="text-[9px] text-right opacity-60 pt-1 mt-1 border-t border-black/5">{fpdInfo.rangeStr}</div>
                                </div>
                            ) : <span className="text-[10px] opacity-70">Sin ventas en {fpdInfo ? fpdInfo.rangeStr : 'periodo'}</span>}
                        </div>
                        <div className="space-y-1">
                             <div onClick={() => { setBreakdownFilter({quota: quotaId, type: 'yaCancelo'}); setFpdQuotaFilter(null); }} className={`${baseRow} ${isActive('yaCancelo') ? 'bg-green-100 ring-2 ring-green-500' : 'bg-slate-50'}`}>
                                <span className="text-xs font-bold text-green-700 flex gap-1"><Icons.DollarSign className="w-3 h-3"/> Ya Canceló</span><span className="font-bold">{stats.yaCancelo}</span>
                             </div>
                             <div onClick={() => { setBreakdownFilter({quota: quotaId, type: 'conGestion'}); setFpdQuotaFilter(null); }} className={`${baseRow} ${isActive('conGestion') ? 'bg-blue-100 ring-2 ring-blue-500' : 'bg-slate-50'}`}>
                                <span className="text-xs font-bold text-blue-700 flex gap-1"><Icons.Handshake className="w-3 h-3"/> Con Gestión</span><span className="font-bold">{stats.conGestion}</span>
                             </div>
                             <div onClick={() => { setBreakdownFilter({quota: quotaId, type: 'noCancelo'}); setFpdQuotaFilter(null); }} className={`${baseRow} ${isActive('noCancelo') ? 'bg-red-100 ring-2 ring-red-500' : 'bg-slate-50'}`}>
                                <span className="text-xs font-bold text-red-600 flex gap-1"><Icons.XCircle className="w-3 h-3"/> No Canceló</span><span className="font-bold">{stats.noCancelo}</span>
                             </div>
                             <div onClick={() => { setBreakdownFilter({quota: quotaId, type: 'vacio'}); setFpdQuotaFilter(null); }} className={`${baseRow} ${isActive('vacio') ? 'bg-slate-200 ring-2 ring-slate-500' : 'bg-slate-50'}`}>
                                <span className="text-xs font-bold text-slate-500 flex gap-1"><Icons.HelpCircle className="w-3 h-3"/> Sin dato</span><span className="font-bold">{stats.vacio}</span>
                             </div>
                        </div>
                    </div>
                );
            };

            const headerColorClass = activeConfig.theme === 'indigo' ? 'border-indigo-500' : 'border-blue-500';

            if (!isAuthenticated) return <Login onLogin={() => setIsAuthenticated(true)} />;

            return (
                <div className="max-w-7xl mx-auto p-4 space-y-6">
                    <div className={`bg-white rounded-xl shadow p-6 border-l-4 ${headerColorClass} flex flex-col md:flex-row justify-between items-center gap-4`}>
                        <div className="flex items-center gap-3">
                            <div className="p-2 bg-slate-100 rounded-lg"><Icons.CreditCard className={`w-6 h-6 text-${activeConfig.theme}-600`} /></div>
                            <div>
                                <h1 className="text-2xl font-bold text-slate-900">Dashboard de Gestión</h1>
                                <div className="flex items-center gap-2 mt-1">
                                    <span className={`inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium ${loading ? 'bg-amber-100 text-amber-700' : 'bg-emerald-100 text-emerald-700'}`}>
                                        <span className={`w-2 h-2 rounded-full ${loading ? 'bg-amber-500 animate-pulse' : 'bg-emerald-500'}`}></span>
                                        {loading ? 'Sincronizando...' : `Actualizado: ${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div className="flex bg-slate-100 p-1.5 rounded-lg items-center gap-3">
                            <div className="relative">
                                <Icons.Database className="w-3 h-3 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none" />
                                <select value={portfolio} onChange={(e) => setPortfolio(e.target.value)} className="appearance-none bg-white border border-slate-200 text-slate-700 font-bold text-sm py-2 pl-3 pr-8 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer min-w-[150px]">
                                    <option value="alocredit">Cartera A</option>
                                    <option value="payjoy">Cartera P</option>
                                </select>
                                <div className="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-500">
                                    <svg className="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                                </div>
                            </div>
                            <div className="h-6 w-px bg-slate-200 mx-1"></div>
                            <button onClick={fetchData} disabled={loading} className="p-1.5 text-slate-400 hover:text-indigo-600 hover:bg-white rounded-md transition-all disabled:opacity-50" title="Recargar datos"><Icons.RefreshCw className={`w-4 h-4 ${loading ? 'animate-spin' : ''}`} /></button>
                        </div>
                    </div>

                    {error && <div className="bg-red-50 p-4 rounded-lg border border-red-200 flex gap-3 text-red-700 items-start"><Icons.AlertCircle className="w-5 h-5 mt-0.5 flex-shrink-0"/><div><h3 className="font-bold text-sm">Error de Conexión</h3><p className="text-xs mt-1">{String(error)}</p></div></div>}

                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div className="bg-white p-3 rounded-lg shadow-sm border border-slate-200">
                            <label className="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1 block">Vendedor</label>
                            <div className="relative">
                                <select className="w-full p-2 bg-slate-50 border border-slate-100 rounded text-sm text-slate-700 outline-none focus:border-indigo-500" value={selectedSeller} onChange={e => setSelectedSeller(e.target.value)}>
                                    <option value="">Todos</option>
                                    {sellers.map((s,i) => <option key={i} value={s}>{s}</option>)}
                                </select>
                            </div>
                        </div>
                        <div className="bg-white p-3 rounded-lg shadow-sm border border-slate-200">
                            <label className="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1 block">Equipo</label>
                            <div className="relative">
                                <select className="w-full p-2 bg-slate-50 border border-slate-100 rounded text-sm text-slate-700 outline-none focus:border-indigo-500" value={selectedDevice} onChange={e => setSelectedDevice(e.target.value)}>
                                    <option value="">Todos</option>
                                    {devices.map((d,i) => <option key={i} value={d}>{d}</option>)}
                                </select>
                            </div>
                        </div>
                        <div className="bg-white p-3 rounded-lg shadow-sm border border-slate-200">
                             <label className="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1 block">Búsqueda</label>
                             <div className="relative">
                                <input type="text" className="w-full p-2 pl-8 bg-slate-50 border border-slate-100 rounded text-sm outline-none focus:border-indigo-500" placeholder="Nombre, cédula..." value={searchTerm} onChange={e => setSearchTerm(e.target.value)} />
                                <Icons.Search className="w-4 h-4 text-slate-400 absolute left-2.5 top-2.5" />
                             </div>
                        </div>
                        <div className="bg-white p-3 rounded-lg shadow-sm border border-slate-200 flex justify-between items-center px-5">
                            <div><p className="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Clientes</p><p className="text-2xl font-bold text-slate-700">{filteredData.length}</p></div>
                            <div className="p-2 bg-indigo-50 text-indigo-600 rounded-lg"><Icons.Users className="w-5 h-5" /></div>
                        </div>
                    </div>

                    {alertStats.total > 0 && (
                        <div className="bg-rose-50 border border-rose-100 rounded-xl p-4 flex flex-col sm:flex-row justify-between items-center gap-4">
                             <div className="flex gap-4 items-center">
                                <div className="p-2.5 bg-white shadow-sm border border-rose-100 rounded-full text-rose-600"><Icons.BellRing className="w-5 h-5"/></div>
                                <div>
                                    <h2 className="text-rose-900 font-bold">{alertStats.total} Clientes en Mora Reciente</h2>
                                    <p className="text-xs text-rose-700 opacity-80">Vencidos hace 5-7 días sin gestión registrada.</p>
                                </div>
                             </div>
                             <button onClick={() => setShowOnlyAlerts(!showOnlyAlerts)} className={`px-5 py-2 rounded-lg text-sm font-bold border transition-all shadow-sm ${showOnlyAlerts ? 'bg-rose-600 text-white border-rose-600' : 'bg-white text-rose-600 border-rose-200 hover:bg-rose-50'}`}>
                                {showOnlyAlerts ? 'Ver Todos' : 'Filtrar Alertas'}
                             </button>
                        </div>
                    )}

                    <div className="bg-slate-100 p-4 rounded-xl border border-slate-200">
                        <div className="flex justify-between items-center mb-4">
                            <h3 className="font-bold text-slate-700 flex items-center gap-2"><div className="w-1 h-5 bg-indigo-500 rounded-full"></div> Análisis de Cohortes</h3>
                            { (fpdQuotaFilter || breakdownFilter) && 
                                <button onClick={() => { setFpdQuotaFilter(null); setBreakdownFilter(null); }} className="text-xs bg-slate-800 text-white px-3 py-1.5 rounded-full flex gap-1.5 items-center hover:bg-slate-700 transition-colors shadow-sm">
                                    <Icons.X className="w-3 h-3"/> Quitar Filtros
                                </button>
                            }
                        </div>
                        
                        <div className="flex justify-center mb-4">
                            {fpdStats.found && (
                                <div className="bg-white px-4 py-2 rounded-full shadow-sm border border-slate-200 flex gap-4 items-center">
                                    <Icons.TrendingDown className="w-5 h-5 text-slate-400"/>
                                    <div className="text-center">
                                        <p className="text-[10px] font-bold text-slate-400 uppercase">Morosidad General</p>
                                        <p className="text-xl font-bold text-slate-700">{fpdStats.totalSalesAll > 0 ? `${fpdStats.generalFPD}%` : 'N/A'}</p>
                                    </div>
                                </div>
                            )}
                        </div>

                        <div className={`grid grid-cols-1 md:grid-cols-${activeConfig.quotas.length} gap-6`}>
                            {activeConfig.quotas.map(quotaId => (
                                <StatCard 
                                    key={quotaId}
                                    title={QUOTA_LABELS[quotaId].label} 
                                    quotaId={quotaId} 
                                    stats={observationStats[quotaId]} 
                                    fpdInfo={fpdStats[quotaId]} 
                                />
                            ))}
                        </div>
                    </div>

                    <div className="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                        <div className="overflow-x-auto">
                            <table className="w-full text-left text-sm text-slate-600">
                                <thead className="bg-slate-50/80 text-xs uppercase tracking-wider font-bold text-slate-500 border-b border-slate-200">
                                    <tr>{headers.map((h, i) => {
                                        const style = getColumnStyles(h);
                                        const isPhoneCol = activeConfig.columns.phone && activeConfig.columns.phone.some(p => h.toLowerCase().includes(p));
                                        return <th key={i} className={`px-4 py-3 whitespace-nowrap ${style?.head} ${isPhoneCol ? 'min-w-[140px]' : ''}`}>{h}</th>
                                    })}</tr>
                                </thead>
                                <tbody className="divide-y divide-slate-100">
                                    {filteredData.length > 0 ? filteredData.map((row, i) => (
                                        <tr key={i} className="hover:bg-slate-50 transition-colors">
                                            {headers.map((h, j) => {
                                                const val = formatCellData(row[h]);
                                                const style = getColumnStyles(h);
                                                let isAlert = false;
                                                
                                                if (style) {
                                                    let qName = '';
                                                    if (h.toLowerCase().includes('primera')) qName='primera';
                                                    if(qName && activeConfig.quotas.some(qId => QUOTA_LABELS[qId].id === qName) && checkSpecificQuotaAlert(row, headers, 'fpd3')) isAlert = true; 
                                                }

                                                const isPhoneCol = activeConfig.columns.phone && activeConfig.columns.phone.some(p => h.toLowerCase().includes(p));
                                                if (isPhoneCol) {
                                                    const clientVal = clientColumn ? row[clientColumn] : '';
                                                    const deviceVal = deviceColumn ? row[deviceColumn] : '';
                                                    const clean = cleanPhoneNumber(val);
                                                    if (clean) {
                                                        return (
                                                            <td key={j} className="px-4 py-3 whitespace-nowrap">
                                                                <div className="flex items-center gap-2">
                                                                    <span className="font-mono text-xs text-slate-500">{val}</span>
                                                                    <div className="flex gap-1">
                                                                        <a href={getWhatsAppLink(val, clientVal, deviceVal)} target="_blank" className="p-1.5 bg-green-50 text-green-600 rounded hover:bg-green-100 border border-green-200 transition-colors" title="WhatsApp"><Icons.MessageCircle className="w-3.5 h-3.5"/></a>
                                                                        <a href={`tel:${clean}`} className="p-1.5 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 border border-blue-200 transition-colors" title="Llamar"><Icons.Phone className="w-3.5 h-3.5"/></a>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        );
                                                    }
                                                }
                                                return (
                                                    <td key={j} className={`px-4 py-3 whitespace-nowrap text-xs ${style?.bgColor} ${isAlert ? 'bg-rose-50 text-rose-700 font-bold border-l-2 border-rose-500' : ''}`}>
                                                        {isAlert && <Icons.AlertTriangle className="w-3 h-3 inline mr-1.5"/>}
                                                        {val}
                                                    </td>
                                                )
                                            })}
                                        </tr>
                                    )) : (
                                        <tr><td colSpan={headers.length} className="px-6 py-24 text-center text-slate-400">
                                            <div className="flex flex-col items-center gap-3">
                                                <div className="p-4 bg-slate-50 rounded-full"><Icons.Search className="w-8 h-8 text-slate-300"/></div>
                                                <p>No se encontraron resultados con los filtros actuales.</p>
                                            </div>
                                        </td></tr>
                                    )}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
